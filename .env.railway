# Heimdall Railway Environment Configuration
# Copy this to Railway dashboard Variables section
# Reference variables from Railway plugins using ${{PluginName.VARIABLE}}

# ============================================
# Server Configuration
# ============================================
ENVIRONMENT=production
PORT=${{PORT}}
ALLOWED_ORIGINS=https://your-frontend-domain.com,https://your-app-domain.com
RATE_LIMIT_PER_MIN=100

# ============================================
# Database Configuration (PostgreSQL Plugin)
# ============================================
# Railway auto-provides DATABASE_URL from PostgreSQL plugin
DATABASE_URL=${{Postgres.DATABASE_URL}}

# Alternative: Use individual variables
# DB_HOST=${{Postgres.PGHOST}}
# DB_PORT=${{Postgres.PGPORT}}
# DB_USER=${{Postgres.PGUSER}}
# DB_PASSWORD=${{Postgres.PGPASSWORD}}
# DB_NAME=${{Postgres.PGDATABASE}}

DB_SSLMODE=require
DB_MAX_CONNS=25
DB_MAX_IDLE=5

# ============================================
# Redis Configuration (Redis Plugin)
# ============================================
# Railway auto-provides REDIS_URL from Redis plugin
REDIS_URL=${{Redis.REDIS_URL}}

# Alternative: Use individual variables
# REDIS_HOST=${{Redis.REDISHOST}}
# REDIS_PORT=${{Redis.REDISPORT}}
# REDIS_PASSWORD=${{Redis.REDISPASSWORD}}

REDIS_DB=0

# ============================================
# JWT Configuration
# ============================================
# Keys are auto-generated in Dockerfile during build
JWT_PRIVATE_KEY_PATH=/app/keys/private.pem
JWT_PUBLIC_KEY_PATH=/app/keys/public.pem
JWT_ACCESS_EXPIRY_MIN=15
JWT_REFRESH_EXPIRY_DAYS=7
JWT_ISSUER=heimdall

# ============================================
# FusionAuth Configuration
# ============================================
# IMPORTANT: Get these from your FusionAuth instance
# Option 1: FusionAuth Cloud (https://fusionauth.io)
# Option 2: Self-hosted FusionAuth
FUSIONAUTH_URL=https://your-instance.fusionauth.io
FUSIONAUTH_API_KEY=your-fusionauth-api-key-here
FUSIONAUTH_TENANT_ID=your-fusionauth-tenant-id-here
FUSIONAUTH_APPLICATION_ID=your-fusionauth-application-id-here

# OAuth callback URL (update with your Railway domain)
OAUTH_REDIRECT_URL=https://your-app.railway.app/v1/auth/oauth/callback

# ============================================
# OPA Configuration (Open Policy Agent)
# ============================================
# Deploy OPA as a separate Railway service, or use embedded policies
# Option 1: Deploy OPA as separate service
OPA_URL=http://opa.railway.internal:8181
# Option 2: Use Railway service reference
# OPA_URL=${{OPA.RAILWAY_PRIVATE_DOMAIN}}:8181
OPA_POLICY_PATH=heimdall/authz
OPA_TIMEOUT_SECONDS=5
OPA_ENABLE_CACHE=true

# ============================================
# MinIO Configuration (Optional - for policy bundles)
# ============================================
# Only needed if using policy bundle distribution
# MINIO_ENDPOINT=minio.railway.internal:9000
# MINIO_ACCESS_KEY=your-minio-access-key
# MINIO_SECRET_KEY=your-minio-secret-key
# MINIO_BUCKET=bundles
# MINIO_USE_SSL=false

# ============================================
# SMTP Configuration (Optional)
# ============================================
# Required for email verification and password reset
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USERNAME=apikey
SMTP_PASSWORD=your-sendgrid-api-key-here
SMTP_FROM=noreply@yourdomain.com

# ============================================
# OAuth Providers (Optional)
# ============================================
# Google OAuth
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

# GitHub OAuth
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

